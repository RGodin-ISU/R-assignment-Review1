# Load libraries
library(ggplot2)
library(dplyr)

# Step 1: Read the data
maize_data <- read.table("maize_joined.txt", header = FALSE, sep = "\t", stringsAsFactors = FALSE)
maize_data <- maize_data[, 2:3]
colnames(maize_data) <- c("Chromosome", "SNP_Position")

teosinte_data <- read.table("teosinte_joined.txt", header = FALSE, sep = "\t", stringsAsFactors = FALSE)
teosinte_data <- teosinte_data[, 2:3]
colnames(teosinte_data) <- c("Chromosome", "SNP_Position")

# Step 2: Filter out invalid SNP positions
filter_data <- function(data) {
    data %>%
        filter(!is.na(SNP_Position) & grepl("^[0-9]+$", SNP_Position)) %>%
        mutate(SNP_Position = as.numeric(SNP_Position))
}

maize_data <- filter_data(maize_data)
teosinte_data <- filter_data(teosinte_data)

# Step 3: Combine the data
maize_data$Species <- "Maize"
teosinte_data$Species <- "Teosinte"
combined_data <- bind_rows(maize_data, teosinte_data)

# Check the structure of the combined data
print("Structure of combined data:")
str(combined_data)

print("First few rows of combined data:")
head(combined_data)

# Step 4: Density plot using ggplot2 (without ggridges)
density_plot <- ggplot(combined_data, aes(x = SNP_Position, fill = Species)) +
    geom_density(alpha = 0.6) +  # Density plot
    facet_wrap(~ Chromosome, scales = "free_y") +  # Separate panels for each chromosome
    scale_fill_manual(values = c("Maize" = "blue", "Teosinte" = "pink")) +  # Custom colors
    labs(title = "SNP Position Distribution by Chromosome",
         x = "SNP Position",
         y = "Density",
         fill = "Species") +
    theme_minimal()

print(density_plot)

# Step 5: Bar plot
snp_counts <- combined_data %>%
    group_by(Chromosome, Species) %>%
    summarise(SNP_Count = n(), .groups = "drop")

bar_plot <- ggplot(snp_counts, aes(x = Chromosome, y = SNP_Count, fill = Species)) +
    geom_bar(stat = "identity", position = "dodge", alpha = 0.8) +  # Bar plot with dodge
    scale_fill_manual(values = c("Maize" = "blue", "Teosinte" = "pink")) +  # Custom colors
    labs(title = "SNP Counts per Chromosome",
         x = "Chromosome",
         y = "SNP Count",
         fill = "Species") +
    theme_minimal()

print(bar_plot)